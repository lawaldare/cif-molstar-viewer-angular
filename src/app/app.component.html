<div class="container">
  <header>
    <h1>Molecular Structure Viewer</h1>
    <p class="subtitle">Upload and visualize .cif files with Molstar</p>
  </header>

  <div class="main-content">
    <div class="upload-section">
      <h2 class="section-title">Upload CIF File</h2>

      <!-- Upload area with drag & drop -->
      <div
        #dropArea
        class="upload-area"
        (dragover)="onDragOver($event)"
        (dragleave)="onDragLeave()"
        (drop)="onDrop($event)"
      >
        <div class="upload-icon">üìÅ</div>
        <p class="upload-text">
          Drag & drop your .cif, .bcif or .ent file here
        </p>
        <p>or</p>

        <!-- Hidden file input -->
        <input
          #fileInput
          type="file"
          class="file-input"
          accept=".cif, .ent, .pdb, .bcif"
          (change)="onFileChange($event)"
          hidden
        />

        <!-- Browse button -->
        <button class="btn" (click)="onBrowseClick()">Browse Files</button>
      </div>

      <!-- Selected file info -->
      @if(currentFile) {
      <div class="file-info">
        <p class="file-name">Selected file: {{ currentFile.name }}</p>
        <p class="file-size">Size: {{ currentFile.size | number }} bytes</p>
        @if(modelSym()){
        <p class="title">Cell Parameters:</p>
        <hr />
        <p class="file-name">File: {{ label() }}</p>
        <p class="file-name first-info">
          A: {{ modelSym()?.spacegroup?.cell?.size?.[0].toFixed(2) }}
        </p>
        <p class="file-name">
          B: {{ modelSym()?.spacegroup?.cell?.size?.[1].toFixed(2) }}
        </p>
        <p class="file-name">
          C: {{ modelSym()?.spacegroup?.cell?.size?.[2].toFixed(2) }}
        </p>
        <p class="file-name">Alpha: {{ modelSymParam()?.[0].toFixed(2) }}</p>
        <p class="file-name">Beta: {{ modelSymParam()?.[1].toFixed(2) }}</p>
        <p class="file-name">Gamma: {{ modelSymParam()?.[2].toFixed(2) }}</p>
        <p class="file-name">
          Space symmetry group: {{ simplifiedSpacegroup() }}
        </p>
        <p class="file-name">Orthogonalisation code: {{ orthoCode() }}</p>
        <p class="file-name">Analysis: {{ analysis() }}</p>
        }
      </div>
      }

      <!-- Messages -->
      @if(facade.errorMsg()) {
      <div class="message error">{{ facade.errorMsg() }}</div>
      } @if(facade.successMsg()) {
      <div class="message success">{{ facade.successMsg() }}</div>
      }
    </div>

    <div class="viewer-section">
      <h2 class="section-title">3D Molecular Visualization</h2>
      <div class="viewer-container">
        <div #viewer id="molstar-viewer"></div>

        <!-- Loading spinner -->
        @if(facade.isLoading()) {
        <div class="loading">
          <div class="spinner"></div>
          <p>Loading structure...</p>
        </div>
        }
      </div>
    </div>
  </div>

  <footer>
    <p>
      Powered by
      <a href="https://www.lawaldare.com/" target="_blank">DreTech </a> |
      Created with Angular
    </p>
  </footer>
</div>
